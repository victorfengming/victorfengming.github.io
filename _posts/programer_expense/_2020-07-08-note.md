---
title: '2020年7月8号笔记'
tags:  
---


### cucumber自动化测试
cucumber是一款测试工具.可用于大多数主流编程语言.比如Java,JS,Ruby,C++,lua,Android,kotlin,C#/F#,PHP,Python,Go,groovy,scala等等.

其中,Java,JS,Ruby的代码托管在cucumber下.官方建议选择与生产代码相同的平台或编程语言的实现.

本文主要是Java平台下的介绍教程.使用方法非常简单,创建一个mvn工程,在pom.xml文件引入一下依赖即可.


```xml
<dependency>
    <groupId>io.cucumber</groupId>
    <artifactId>cucumber-java8</artifactId>
    <version>4.2.0</version>
    <scope>test</scope>
</dependency>
```

也可根据骨架创建cucumber项目.
### 创建一个空的cucumber项目
我们首先使用cucumber-prototype Maven插件创建一个新项目目录.打开终端,转到要创建项目的目录(比如本文是hellocucumber),运行一下命令:

```cmd
mvn archetype:generate                      \
   -DarchetypeGroupId=io.cucumber           \
   -DarchetypeArtifactId=cucumber-archetype \
   -DarchetypeVersion=2.3.1.2               \
   -DgroupId=hellocucumber                  \
   -DartifactId=hellocucumber               \
   -Dpackage=hellocucumber                  \
   -Dversion=1.0.0-SNAPSHOT                 \
   -DinteractiveMode=false
```

你应该得到如下结果:
```cmd
[INFO] Project created from Archetype in dir: hellocucumber/cucumber
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
```

切换到刚才运行命令创建的目录:
```cmd
cd hellocucumber
```

在idea中打开项目:
文件->打开...->(选择pom.xml)
选择open as project

现在,您已经安装了一个简单的cucumber项目.

### 验证cucumber安装

```cmd
mvn test
```

您应该看到如下内容:
```xml
-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running hellocucumber.RunCucumberTest
No features found at [classpath:hellocucumber]

0 Scenarios
0 Steps
0m0.004s

Tests run: 0, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.541 sec

Results :

Tests run: 0, Failures: 0, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------


cucumber的输出告诉我们它没有找到任何可以运行的东西.

### 写一个scenario(场景)
当我们使用cucumber进行行为驱动开发时,我们使用具体的例子来指定我们希望软件做什么.scenario是在生产代码之前编写的.它们以可执行规范的形式开始生命.随着生产代码的出现,场景扮演了事实文档和自动化测试的角色.

在cucumber中,一个example称为scenario. scenario定义在.feature文件中,这些文件存储在src/test/resources/hellocucumber目录(或子目录)中.

一个具体的例子就是:星期天不是星期五.

创建一个名为`src/test/resources/hellocucumber/is_it_friday_yet.feature`的文件,文件包括以下内容:

```xml
Feature: Is it Friday yet?
  Everybody wants to know when it's Friday

  Scenario: Sunday isn't Friday
    Given today is Sunday
    When I ask whether it's Friday yet
    Then I should be told "Nope"
```

这个文件的第一行以关键字'''Feature'''开始: 后面跟着一个名称.最好使用与文件名类似的名称.

第二行是对该特性的简要描述.cucumber并不执行这一行,它只是一个文档.

第4行,场景:sunday is not friday 是一个scenario, 它是说明软件应该如何工作的具体示例.
最后三行以Given开头,when和then是我们的场景的步骤.这就是cucumber将要执行的操作.

### 看一个未定义的scenario报告
现在我们有了场景,我们可以让cucumber执行它:
mvn test
cucumber告诉我们有一个undefined的场景和三个undefined的步骤.它还建议我们使用一些代码片段来define这些步骤:

```
-------------------------------------------------------
 T E S T S
-------------------------------------------------------
```java
Running hellocucumber.RunCucumberTest
Feature: Is it Friday yet?
  Everybody wants to know when it's Friday

  Scenario: Sunday isn't Friday        # hellocucumber/is_it_friday_yet.feature:4
    Given today is Sunday              # null
    When I ask whether it's Friday yet # null
    Then I should be told "Nope"       # null

1 Scenarios (1 undefined)
3 Steps (3 undefined)
0m0.040s


You can implement missing steps with the snippets below:

@Given("^today is Sunday$")
public void today_is_Sunday() {
    // Write code here that turns the phrase above into concrete actions
    throw new PendingException();
}

@When("^I ask whether it's Friday yet$")
public void i_ask_whether_it_s_Friday_yet() {
    // Write code here that turns the phrase above into concrete actions
    throw new PendingException();
}

@Then("^I should be told \"([^\"]*)\"$")
public void i_should_be_told(String arg1) {
    // Write code here that turns the phrase above into concrete actions
    throw new PendingException();
}
```

## 重构
现在我们有了工作代码，我们应该做一些重构:

我们应该将isItFriday方法从测试代码移到生产代码中。
我们可以在某个时候从步骤定义中提取helper方法，用于我们在几个地方使用的方法。
## 总结
在这个简短的教程中，您已经了解了如何安装Cucumber，如何遵循BDD流程来开发一个非常简单的方法，以及如何使用该方法来评估多个场景!

作者：Graddy
链接：https://www.jianshu.com/p/60122d38a08a
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。